---
title: "Gov 50 Final Project"
author: "Brecon Welch"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

I'm interested in exploring data related to Formula 1 Drivers. By looking at the technology and innovation of Formula 1 cars and integrated machine learning strategies, I want to see how driver's careers are impacted both in terms of success and longevity. I would measure this through car performance and driver performance statistics over a period of time. 


## Proposal
Does the car or driver matter more in Formula 1? In this study I plan to examine how the role of technology and innovation in Formula 1 impacts driver performance and longevity. Furthermore, I want to analyze the relationship between different technological advancements and the trajectory of drivers' careers in terms of both success and length of career. I hypothesize that while drivers with much more technologically advanced cars than their competition will perform better, the amount of experience will play a bigger role when the car technology margins are smaller. In other words, while advancements in car performance will increase both the success rate and longevity of F1 drivers overall, the influence of technological changes on driver performance will vary depending on a driver's experience and skill. This hypothesis is rooted in the theory that technology and innovation have a profound impact on the outcomes in motorsports. Advancements in car performance can lead to better speed, handling, safety, and reliability. Consequently, drivers benefit from improved machinery, which can enhance their performance and extend their careers. My explanatory variable of interest is "Technological Advancements in Car Performance" which I will measure by assessing technological changes in Formula 1 cars over time. These changes may include improvements in engine power, aerodynamics, materials, safety features, and onboard systems. To study this variable, I will examine historical records, technical specifications, and innovations introduced by F1 teams. My outcome variable of interest is "Driver Success Rate and Longevity" which I will measure by evaluating a driver's performance in terms of race results, points earned, wins, podium finishes, and the duration of their career in Formula 1. To study this variable, I will look at data on driver performance, career achievements, and historical race statistics. There are two main patterns that if observed in the data would support my hypothesis. The first is if the data reveals a positive and statistically significant correlation between technological advancements in car performance and driver success rates (e.g., more wins and podium finishes). The second would be if the data demonstrates that drivers in eras with significant technological innovations tend to have longer and more successful careers. However, my hypothesis could be disproven if there is no significant correlation between technological advancements in car performance and driver success rates or if the data indicates that experienced and less-experienced drivers are equally affected by technological changes, without significant variations in their performance.

```{r}
library(tidyverse)
f1 <- read_csv("archive (1)/status.csv")
f1

f1_drivers <- read_csv("formula1-dataset-master/formula1_data_races.csv")
f1_drivers

F1D <- read_csv("F1Drivers_Dataset.csv")
F1D

races <- read_csv("races.csv")
drivers <- read_csv("drivers.csv")
results <- read_csv("results.csv.zip")
```
#Part 3
```{r}
library(ggplot2)
F1data <- data.frame(
  name = c("Lewis Hamilton", "Michael Schumacher", "Sebastian Vettel", "Alain Prost", "Ayrton Senna", "Max Verstappen", "Fernando Alonso", "Nigel Mansell", "Jackie Stewart", "Niki Lauda"),
  Win_Rate = c("0.331189711", "0.295454545", "0.176666667", "0.252475248", "0.253086420", "0.219512195", "0.089136490", "0.162303665", "0.270000000", "0.141242938"),
  Years_Active = c("16", "19", "16", "13", "11", "8", "19", "15", "9", "13")
)

F1data <- F1data |> 
  mutate(Years_Active = factor(Years_Active, levels=c('8','9','11','13','15','16','19')))


ggplot(F1data, aes(x = Years_Active, y = Win_Rate, color = name)) +
  geom_point() +
  labs(title = "Win Rate vs. Years Active by Driver", x = "Years Active", y = "Win Rate")
```



#Part 4
```{r}
win <- ggplot(data = F1D,
       aes(x = Years_Active, y = Win_Rate)) +
  geom_point() + geom_smooth(method = 'loess', formula = 'y ~ x')  + labs(title = "Win Rate vs. Years Active", x = "Years Active", y = "Win Rate")
win

podium <- ggplot(data = F1D,
       aes(x = Years_Active, y = Podium_Rate)) +
  geom_point() + geom_smooth(method = 'loess', formula = 'y ~ x') + labs(title = "Podium Rate vs. Years Active", x = "Years Active", y = "Podium Rate")
podium
```

As seen in these two visualizations, more wins and podium placements tend to be occur with a longer F1 career. While a driver has more chances to win or place on the podium if he competes for more years, we can see here that there is a stronger correlation between podium rate and win rate. This could be explained in several different ways. For instance, drivers will improve their driving strategies and skills as they participate in more competitions, which could explain their ability to earn more podium positions as their careers is longer. On the other hand, this increase win and podium rate could be due to technological improvements in the cars themselves enabling the drivers to perform better. While this analysis does not directly look at technological improvements, it is a helpful starting point to better understand the main differences in F1 career performances and longevity. With more analysis of confounding variables, I hope to discover the reasoning behind this correlation in order to give insight into whether the car or driver matters more for F1. 


#5
```{r}
library(tidyr)

results_agg_total <- inner_join(drivers,results,by = "driverId")

results_agg_total <- inner_join(races,results_agg_total,by = "raceId")

results_agg_total <- results_agg_total |> unite(name, forename, surname, sep=" ")

results_podium_finishers <- results_agg_total |> 
  filter(position==1|position==2|positionText==3)

mostpodiums <- as.data.frame(sort(table(results_podium_finishers$name), decreasing=TRUE)[1:10])


merged_data <- merge(F1data, results_podium_finishers, by = "name")
merged_data <- merged_data[order(as.Date(merged_data$dob)), ]

pod_plot <- ggplot(merged_data, aes(x = Win_Rate, y = dob, color = name)) +
  geom_point() + geom_smooth() +
  labs(title = "Comparison of Top Podium Finishers and Date of Birth",
      x = "Win Rate",
       y = "Date of Birth",
       color = "Driver") + coord_flip() +  theme(axis.text.y = element_text(angle = 0, hjust = 1),
        axis.text.x = element_text(angle = 45, hjust = 1))

retirements <- results_agg_total |> filter(positionText=="R") |>
  mutate(ret = )
mostrets <- as.data.frame(sort(table(retirements$name), decreasing=TRUE)[1:10])

ret_plot <- ggplot(mostrets, aes (x = Freq, y = Var1)) + geom_point() + labs(x = "Total Retirements", y = "Driver Name", title = "Most Retirements by Driver")
ret_plot


most_retire <- as.data.frame(sort(table(retirements$name), decreasing=TRUE))
races_total <- as.data.frame(sort(table(results_agg_total$name), decreasing=TRUE))
freq_retire <- inner_join(most_retire, races_total, by="Var1")
freq_retire$pct <- freq_retire$Freq.x/freq_retire$Freq.y   
freq_retire <- arrange(freq_retire, desc(pct))

freq_ret <- filter(freq_retire, Freq.y >= 20)

freq_ret <- slice(freq_ret, 1:10)

freq_plot <- ggplot(freq_ret, aes(x = pct, y = reorder(Var1, pct))) + geom_point() + labs(x = "Total Retirement Percentage", y = "Driver Name", title = "Least Frequent Retirements (20 Or More Races)")
freq_plot

top_10 <- inner_join(results_podium_finishers,F1data,by = "name")
top_10$dob <- factor(top_10$dob, levels = unique(sort(top_10$dob)))
top_plot <- ggplot(top_10, aes(x = dob, y = name)) + geom_point() + labs(x = "Date of Birth", y = "Driver Name", title = "Top 10 Winningest Drivers by Date of Birth") +  theme(axis.text.y = element_text(angle = 0, hjust = 1),
        axis.text.x = element_text(angle = 45, hjust = 1))
top_plot


Fit <- lm(Win_Rate ~ Nationality + FastLap_Rate + Decade + Podium_Rate + Years_Active, data = F1D) 
```



Lewis Hamilton is third on the winning percentage but his retirement percentage is very low that means he is one of the drivers who “finished” lots of races. The greatest of the drivers such as Michael Schumacher, Prost, and Senna had very high retirement percentages in their career.



